# F-035: Data & privacy: Anonymous default

## Metadata

- Feature ID: F-035
- Category: Data & privacy
- Owner: Engineering + Product
- Status: done
- Slug: data-and-privacy-anonymous-default

## Scores

- Baseline Score: 5/10
- Engineering Score: 5/10
- Founder Score: 0/10
- Founder 10/10 Rule: only founder can assign 10/10

## User Expectation

- Anonymous default

## 10/10 Definition

- Behavior is reliable, predictable, and validated on desktop and mobile.
- Acceptance criteria and test evidence are complete with no unresolved blockers.

## Methodology References

- M00
- M05

## Device Contracts

### Desktop

- Primary interaction path is discoverable in one clear route.
- Error and recovery states are visible and actionable.

### Mobile

- Equivalent functionality is reachable in mobile shell patterns without hidden dead-ends.
- Touch targets and readability remain usable at 375/390 widths.

## Scope

### In scope

- Feature behavior and UX quality for: Anonymous default
- Tracking and regression prevention for this feature

### Out of scope

- Unrelated feature changes not mapped to F-035

## Interfaces Touched

- `src/app/api/mock-account/session/route.ts`
- `src/app/settings/page.tsx`
- `src/lib/privacy/retention.ts`
- `__tests__/mock-account-api.test.ts`

## Dependencies

- SA-003
- SA-009

## Acceptance Criteria

- [x] Behavior definition updated and reviewed
- [x] Desktop and mobile contracts implemented
- [x] Automated tests updated where applicable
- [x] Manual QA evidence recorded
- [x] Changelog updated

## Test Matrix

- [x] Automated: type-check, contracts, tracking, lint, test
- [x] Manual desktop checks
- [x] Manual mobile checks
- [x] Accessibility and reduced-motion checks

## Risks and Rollback

- Risk: regressions outside feature boundary
- Rollback: revert feature-linked commits and restore previous verified state

## Incremental Outcomes Log

| Date       | Commit  | Decision IDs           | Feature ID | Change Summary                                                                                                                                                                                                                                                                                | Verification                             | Score Delta          | Residual Gaps                                                                          |
| ---------- | ------- | ---------------------- | ---------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------- | -------------------- | -------------------------------------------------------------------------------------- |
| 2026-02-15 | pending | SA-003, SA-009, SA-014 | F-035      | Implemented explicit anonymous-default privacy session UX in settings with mode switch (`anonymous` vs `mock_account`) and analytics opt-in controls wired to `/api/mock-account/session`; API now returns `isAnonymousDefault`, capabilities, and retention metadata.                        | `lint`, `type-check`, `test`, `verify:*` | 5 -> 7 (engineering) | Manual UX validation still needed for mode-toggle copy and mobile interaction cadence. |
| 2026-02-18 | pending | SA-003, SA-018         | F-035      | Enforced sign-in requirement for persistent save-state APIs (`/api/bookmarks`, `/api/annotations`) while preserving no-account audit browsing. Save/delete writes now return explicit `AUTH_REQUIRED_SAVE_STATE` when unauthenticated and use account-scoped storage keys when authenticated. | `lint`, `type-check`, `test`, `verify:*` | 7 -> 7.5             | Manual UX validation still needed for mode-toggle copy and mobile interaction cadence. |

## Next Increment

- [ ] Validate anonymous-first messaging tone and discoverability on mobile
- [ ] Add explicit post-auth merge note in privacy settings copy
