# F-021: Soul Audit: 3 AI + 2 prefab split

## Metadata

- Feature ID: F-021
- Category: Soul Audit
- Owner: Engineering + Product
- Status: in-progress
- Slug: soul-audit-3-ai-plus-2-prefab-split

## Scores

- Baseline Score: 5/10
- Engineering Score: 7/10
- Founder Score: 0/10
- Founder 10/10 Rule: only founder can assign 10/10

## User Expectation

- 3 AI + 2 prefab split

## 10/10 Definition

- Behavior is reliable, predictable, and validated on desktop and mobile.
- Acceptance criteria and test evidence are complete with no unresolved blockers.

## Methodology References

- M00
- M02
- M03
- M06

## Device Contracts

### Desktop

- Primary interaction path is discoverable in one clear route.
- Error and recovery states are visible and actionable.

### Mobile

- Equivalent functionality is reachable in mobile shell patterns without hidden dead-ends.
- Touch targets and readability remain usable at 375/390 widths.

## Scope

### In scope

- Feature behavior and UX quality for: 3 AI + 2 prefab split
- Tracking and regression prevention for this feature

### Out of scope

- Unrelated feature changes not mapped to F-021

## Interfaces Touched

- `src/lib/soul-audit/matching.ts`
- `src/lib/soul-audit/curation-engine.ts`
- `src/app/api/soul-audit/submit/route.ts`
- `__tests__/soul-audit-flow.test.ts`
- `__tests__/soul-audit-curation.test.ts`

## Dependencies

- F-023
- F-025

## Acceptance Criteria

- [x] Behavior definition updated and reviewed
- [x] Desktop and mobile contracts implemented
- [x] Automated tests updated where applicable
- [ ] Manual QA evidence recorded
- [x] Changelog updated

## Test Matrix

- [x] Automated: type-check, contracts, tracking, lint, test
- [ ] Manual desktop checks
- [ ] Manual mobile checks
- [ ] Accessibility and reduced-motion checks

## Risks and Rollback

- Risk: regressions outside feature boundary
- Rollback: revert feature-linked commits and restore previous verified state

## Incremental Outcomes Log

| Date       | Commit  | Decision IDs   | Feature ID | Change Summary                                                                                                                                                                                  | Verification                                                          | Score Delta          | Residual Gaps                                                              |
| ---------- | ------- | -------------- | ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------- | -------------------- | -------------------------------------------------------------------------- |
| 2026-02-14 | pending | SA-002, SA-005 | F-021      | Hardened split reliability by preferring series with complete 5-day candidate coverage so the 3 AI + 2 prefab contract remains stable end-to-end.                                               | `type-check`, `lint`, `test` (`soul-audit-flow`, `curation`, edge)    | 5 -> 7 (engineering) | Manual in-browser touch QA still required.                                 |
| 2026-02-14 | pending | SA-013         | F-021      | Added deterministic series-taxonomy fallback option builder so submit never dead-ends when curated candidates are unavailable, while still enforcing 3 AI + 2 prefab.                           | `type-check`, `lint`, `test` (`fallback-options`, `flow`, `curation`) | 7 -> 7.5             | Manual production data QA still required.                                  |
| 2026-02-14 | pending | SA-013         | F-021      | Reworded no-options submit-path error into actionable user language so failures, if any, do not present backend-style copy.                                                                     | `type-check`, `lint`, `test` (`soul-audit-flow`)                      | 7.5 -> 7.6           | End-to-end copy review in live environment still needed.                   |
| 2026-02-15 | pending | SA-006, SA-013 | F-021      | Added results-stage interaction controls: option reasoning accordion, one-time typed reroll confirmation, and session-safe option set replacement that clears stale consent/selection state.    | `type-check`, `lint`, contracts, tracking gates                       | 7.6 -> 8.1           | Save-for-later activation persistence still needs backend completion.      |
| 2026-02-15 | pending | SA-013         | F-021      | Added `Save for later` controls on option cards, a saved-paths panel in results, and monthly clean-house cleanup for stale saved options to reduce curation clutter over time.                  | `type-check`, `lint`, contracts, tracking gates                       | 8.1 -> 8.4           | Backend activation flow for saved options across runs remains in progress. |
| 2026-02-15 | pending | SA-013, SA-014 | F-021      | Fixed reroll state leakage across runs by clearing `soul-audit-reroll-used` on fresh submit/reset/recovery paths, and resetting in-memory reroll flags when reloading options after run expiry. | `lint`, `type-check`, `test`, `verify:*`                              | 8.4 -> 8.7           | Browser-level interaction QA for rapid reroll/recover edge cases pending.  |

## Next Increment

- [ ] Run full browser path checks for selection UI and split telemetry rendering
- [ ] Capture manual QA evidence for desktop/mobile + light/dark
