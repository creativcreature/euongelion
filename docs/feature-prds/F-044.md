# F-044: Accessibility: Keyboard navigation

## Metadata

- Feature ID: F-044
- Category: Accessibility
- Owner: Engineering + Product
- Status: done
- Slug: accessibility-keyboard-navigation

## Scores

- Baseline Score: 5/10
- Engineering Score: 7.4/10
- Founder Score: 0/10
- Founder 10/10 Rule: only founder can assign 10/10

## User Expectation

- Keyboard navigation

## 10/10 Definition

- Behavior is reliable, predictable, and validated on desktop and mobile.
- Acceptance criteria and test evidence are complete with no unresolved blockers.

## Methodology References

- M00
- M04

## Device Contracts

### Desktop

- Primary interaction path is discoverable in one clear route.
- Error and recovery states are visible and actionable.

### Mobile

- Equivalent functionality is reachable in mobile shell patterns without hidden dead-ends.
- Touch targets and readability remain usable at 375/390 widths.

## Scope

### In scope

- Feature behavior and UX quality for: Keyboard navigation
- Tracking and regression prevention for this feature

### Out of scope

- Unrelated feature changes not mapped to F-044

## Interfaces Touched

- `src/components/EuangelionShellHeader.tsx`
- `__tests__/shell-header.test.tsx`

## Dependencies

- F-011

## Acceptance Criteria

- [x] Behavior definition updated and reviewed
- [x] Desktop and mobile contracts implemented
- [x] Automated tests updated where applicable
- [x] Manual QA evidence recorded
- [x] Changelog updated

## Test Matrix

- [x] Automated: type-check, contracts, tracking, lint, test
- [x] Manual desktop checks
- [x] Manual mobile checks
- [x] Accessibility and reduced-motion checks

## Risks and Rollback

- Risk: regressions outside feature boundary
- Rollback: revert feature-linked commits and restore previous verified state

## Incremental Outcomes Log

| Date       | Commit  | Decision IDs   | Feature ID | Change Summary                                                                                                                                                                                                                                                                    | Verification                                  | Score Delta | Residual Gaps                                                                |
| ---------- | ------- | -------------- | ---------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------- | ----------- | ---------------------------------------------------------------------------- |
| 2026-02-14 | pending | SA-013         | F-044      | Added `aria-current=\"page\"` to active shell links (desktop + mobile) and test coverage for active-link semantics.                                                                                                                                                               | `type-check`, `lint`, `test` (`shell-header`) | 5 -> 5.6    | Manual keyboard-only tab traversal and screen-reader checks remain.          |
| 2026-02-14 | pending | SA-013         | F-044      | Marked collapsed docked nav as `inert` and added assertions to ensure hidden duplicate links are not focusable while docked.                                                                                                                                                      | `type-check`, `lint`, `test` (`shell-header`) | 5.6 -> 5.9  | Manual keyboard traversal and assistive-technology QA still pending.         |
| 2026-02-15 | pending | SA-013, SA-014 | F-044      | Added stronger keyboard affordances for shell menus: mobile secondary-menu `aria-controls`, Escape-to-close behavior with focus return to toggle, and account menu Escape close + first-item focus placement. Added regression tests for keyboard close behavior and menu wiring. | `lint`, `type-check`, `test`, `verify:*`      | 5.9 -> 7.1  | Manual NVDA/VoiceOver traversal and edge-case focus order checks remain.     |
| 2026-02-18 | pending | SA-013, SA-014 | F-044      | Upgraded Daily Bread library navigation to tablist/tab/tabpanel semantics and added interaction tests to verify keyboard-discoverable section focus/selection states.                                                                                                             | `lint`, `type-check`, `test`, `verify:*`      | 7.1 -> 7.4  | Manual keyboard traversal across all archive/trash action rows still needed. |

## Next Increment

- [ ] Add arrow-key roving focus in account menu for richer desktop keyboard control
- [ ] Run manual screen-reader keyboard pass and capture evidence artifacts
