# F-011: Navigation: Menu correctness

## Metadata

- Feature ID: F-011
- Category: Navigation
- Owner: Engineering + Product
- Status: in-progress
- Slug: navigation-menu-correctness

## Scores

- Baseline Score: 4/10
- Engineering Score: 8/10
- Founder Score: 0/10
- Founder 10/10 Rule: only founder can assign 10/10

## User Expectation

- Menu correctness

## 10/10 Definition

- Behavior is reliable, predictable, and validated on desktop and mobile.
- Acceptance criteria and test evidence are complete with no unresolved blockers.

## Methodology References

- M00
- M01
- M04
- M06

## Device Contracts

### Desktop

- Primary interaction path is discoverable in one clear route.
- Error and recovery states are visible and actionable.

### Mobile

- Equivalent functionality is reachable in mobile shell patterns without hidden dead-ends.
- Touch targets and readability remain usable at 375/390 widths.

## Scope

### In scope

- Feature behavior and UX quality for: Menu correctness
- Tracking and regression prevention for this feature

### Out of scope

- Unrelated feature changes not mapped to F-011

## Interfaces Touched

- `src/components/EuangelionShellHeader.tsx`
- `src/app/page.tsx`
- `src/app/globals.css`
- `__tests__/shell-header.test.tsx`
- `src/app/providers.tsx`
- `src/stores/uiStore.ts`
- `src/components/Navigation.tsx`

## Dependencies

- F-009
- F-010

## Acceptance Criteria

- [x] Behavior definition updated and reviewed
- [x] Desktop and mobile contracts implemented
- [x] Automated tests updated where applicable
- [ ] Manual QA evidence recorded
- [x] Changelog updated

## Test Matrix

- [x] Automated: type-check, contracts, tracking, lint, test
- [ ] Manual desktop checks
- [ ] Manual mobile checks
- [ ] Accessibility and reduced-motion checks

## Risks and Rollback

- Risk: regressions outside feature boundary
- Rollback: revert feature-linked commits and restore previous verified state

## Incremental Outcomes Log

| Date       | Commit  | Decision IDs           | Feature ID | Change Summary                                                                                                                                                                                          | Verification                                                         | Score Delta          | Residual Gaps                                                   |
| ---------- | ------- | ---------------------- | ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------- | -------------------- | --------------------------------------------------------------- |
| 2026-02-14 | pending | SA-013, SA-014, SA-015 | F-011      | Removed duplicated homepage header/navigation logic and consolidated route menu rendering into shared shell header across pages.                                                                        | `type-check`, `lint`, `test` (`build` blocked on Node 25 `WasmHash`) | 4 -> 5 (engineering) | Manual route walkthrough still required for full 10/10 signoff. |
| 2026-02-14 | pending | SA-013, SA-014, SA-015 | F-011      | Mobile shell polish pass: improved sticky mobile nav/ticker layout, adjusted responsive type scale/spacing, and reduced masthead clipping/overflow risk on narrow screens.                              | `type-check`, `lint`, `test` (64 pass)                               | 5 -> 6 (engineering) | Manual mobile QA on physical devices still required.            |
| 2026-02-14 | pending | SA-013, SA-014, SA-015 | F-011      | Added reusable breadcrumb navigation across recommendation-flow pages (`/series`, `/wake-up`, series detail, devotional detail, `/soul-audit/results`, `/my-devotional`) with shared newspaper styling. | `type-check`, `lint`, `test` (64 pass)                               | 6 -> 7 (engineering) | Manual UX copy pass may still refine breadcrumb labels.         |
| 2026-02-14 | pending | SA-013, SA-014, SA-015 | F-011      | Desktop docked-nav layout now uses a stable center slot for menu links; mobile menu split into primary/secondary groups with explicit toggle and improved overflow control.                             | `type-check`, `lint`, `test` (`shell-header`)                        | 7 -> 8 (engineering) | Full route-by-route nav walkthrough still required.             |
| 2026-02-14 | pending | SA-013, SA-014, SA-015 | F-011      | Added provider-level scroll unlock recovery and removed legacy body-overflow menu locks to prevent scroll freezes during route/menu transitions.                                                        | `type-check`, `lint`, `test` (`shell-header`)                        | 8 -> 8 (engineering) | Manual mobile browser swipe/scroll QA still required.           |
| 2026-02-14 | pending | SA-013                 | F-011      | Normalized shared shell frame behavior for non-home wrappers (`newspaper-home`/`newspaper-reading`), added safe-area sticky offsets, and hardened nav docking updates with observer-assisted recompute. | `type-check`, `lint`, `test` (`shell-header`), contract gates        | 8 -> 8.2             | Manual route-by-route sticky verification still required.       |
| 2026-02-14 | pending | SA-013                 | F-011      | Added route-change mobile menu reset so expanded secondary menu state cannot leak to the next page and obscure sticky shell controls.                                                                   | `type-check`, `lint`, `test` (`shell-header`)                        | 8.2 -> 8.4           | Manual cross-route mobile nav QA still required.                |
| 2026-02-14 | pending | SA-013                 | F-011      | Added route-change regression coverage for mobile menu reset using realistic interaction events and rerendered path transitions.                                                                        | `type-check`, `lint`, `test` (`shell-header`)                        | 8.4 -> 8.5           | Manual browser QA remains required before founder 10/10.        |
| 2026-02-14 | pending | SA-013                 | F-011      | Hardened route-level scroll unlock by clearing stale inline lock styles (`overflow`/`position`/`top`/`width`) from `body` and `html` on route transitions.                                              | `type-check`, `lint`, `test` (`shell-header`)                        | 8.5 -> 8.6           | Physical-device scroll-stress QA still required.                |
| 2026-02-14 | pending | SA-013                 | F-011      | Increased shell nav hit-area geometry (min-height + padding + inline-flex alignment) to reduce brittle click/tap behavior while preserving visual fidelity.                                             | `type-check`, `lint`                                                 | 8.6 -> 8.7           | Manual interaction QA still required on physical devices.       |

## Next Increment

- [ ] Execute full desktop/mobile route navigation walkthrough and log evidence
- [ ] Run keyboard-only nav traversal against docked + expanded mobile states
