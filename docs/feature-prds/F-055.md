# F-055: Fix Devotional Page Hydration Mismatch

**Status:** Implemented
**Priority:** Critical (production P0 — all devotional pages broken)

---

## Problem

Every devotional page in both `/wake-up/devotional/` and `/devotional/` routes was permanently stuck on "Loading: Preparing your devotional." Content never rendered.

## Root Cause

`EuangelionShellHeader` initialized its date state with `useState(() => new Date())`. Because this component is SSR'd inside the devotional page tree, the server renders one timestamp and the client hydrates with a different one. React 19 throws a hard hydration mismatch error, which prevents the entire component tree from mounting — blocking all `useEffect` hooks, including the devotional JSON fetch.

Other pages (home, series, series detail) were unaffected because their component trees either recovered from the mismatch or didn't depend on useEffect for primary content loading.

## Fix

1. **Deferred date initialization**: Changed `useState(() => new Date())` to `useState<Date | null>(null)` with the actual date set in a client-side `useEffect`.
2. **Null-safe rendering**: `<time>` element uses `now?.toISOString() ?? ''` and `suppressHydrationWarning`.
3. **CSP dev-mode fix**: Added `'unsafe-eval'` to Content-Security-Policy in development mode only, so Next.js Fast Refresh (which requires eval) works without errors.

## Files Changed

- `src/components/EuangelionShellHeader.tsx` — Null initial date state, guarded rendering
- `next.config.ts` — Dev-mode CSP includes `'unsafe-eval'`
- `__tests__/screen-reader-landmarks-contract.test.ts` — Updated assertion for new dateTime pattern

## Outcome

- Devotional pages load and render content correctly
- No hydration errors in console
- Zero visual regression on other pages

## Methodology References

- M00: Unified methodology (bugfix — no UX change)

## Acceptance Criteria

### Desktop

- Devotional pages at `/wake-up/devotional/*` and `/devotional/*` render content within 3 seconds
- No React hydration errors in browser console
- Date in topbar renders correctly after initial client paint

### Mobile

- Same as desktop — devotional pages render content on mobile viewports
- No layout shift from deferred date initialization (non-breaking space placeholder)
