# F-052: Artwork image layer (series heroes + devotional inline + lightbox)

## Metadata

- Feature ID: F-052
- Category: Visual / Content
- Owner: Engineering
- Status: done
- Slug: artwork-image-layer

## Scores

- Baseline Score: 0/10
- Engineering Score: 7/10
- Founder Score: 0/10
- Founder 10/10 Rule: only founder can assign 10/10

## User Expectation

- Series cards show iconic artwork as full-bleed hero backgrounds (Apple TV style)
- Devotional reading experience includes inline historic artwork at editorial breakpoints
- Clicking artwork opens a lightbox gallery with full museum attribution
- Dark/light mode shows artwork without inversion — natural image rendering in both modes

## 10/10 Definition

- Every series card (32) has a curated hero artwork as blue woodprint
- Every devotional (170) has 3+ inline artworks with compact attribution
- Lightbox gallery works with swipe, arrow keys, Escape, and focus trap
- Single image source (print.webp) eliminates hydration mismatch risk
- LCP < 2.5s with lazy loading on below-fold images
- All 639 artworks attributed (title, artist, year, medium, museum, license)
- Relevance field connects each artwork to its devotional passage (future curation)

## Methodology References

- M00

### Desktop

- Series cards: full-bleed hero artwork with scrim gradient, text readable at 1024px+
- Devotional reader: 3+ inline artworks at editorial breakpoints between modules
- Lightbox: centered image (max 900px), arrow navigation, Escape close, focus trap

### Mobile

- Series cards: full-bleed hero artwork at 375px, single column, scrim gradient
- Devotional reader: inline artwork scales to full width in 4:3 aspect ratio
- Lightbox: swipe navigation (arrows hidden), full-width image, tap close

## Implementation

### Build-time manifest

- `scripts/generate-artwork-manifest.mjs` reads artwork.json files, generates typed manifest
- Hero scoring: named artist (+3), painting (+3), sculpture (+2), pre-1800 (+1), day-1 (+2)
- Round-robin redistribution fills every devotional to 3+ artworks
- Output: `src/data/artwork-manifest.ts` with SERIES_HERO, DEVOTIONAL_ARTWORKS, ALL_ARTWORKS

### Series card heroes

- Three card variants: large/medium (Title → Keywords → Image → Scripture → Action), small (Title → Keywords → Action, no image)
- Contained thumbnail (not full-bleed); print.webp for cards, rawSrc for reading
- No dark mode image inversion — artwork renders naturally in both modes
- Applied to BrowseSeriesCard, homepage featured rail, SeriesHero fallback, Soul Audit option cards

### Inline devotional artwork

- DevotionalArtwork component with cinematic 4:3 frames
- ArtworkAttribution component (compact inline + full museum card)
- artwork-placement.ts calculates insertion points between modules

### Lightbox gallery

- ArtworkLightbox with full museum card attribution
- Navigation: swipe, arrow keys, Escape close
- Focus trap + body scroll lock
- useLightbox hook manages gallery state

## Outcomes Log

- 2026-02-22: Initial implementation complete. 319 artworks mapped, 32 heroes, 170 devotionals with 3+ images. Series card heroes visually verified at desktop, mobile (375px), dark and light mode. Devotional inline artwork verified via type-check + lint + build (visual QA blocked by pre-existing CSP hydration issue in dev).
- 2026-02-23: Blue woodprint remap. Replaced dual print-dark/print-light with unified print.webp (blue-on-white woodprint, #171b69). 639 artworks (up from 319). Dark mode via CSS filter: invert(1). Card scrim gradient tuned for legibility. Added relevance field to ArtworkEntry. 50 new artwork.json generated for metadata gaps. Visual QA passed at 375px + 1024px, dark + light modes.
- 2026-02-23: Card redesign + raw image split. Three card variants (large/medium/small) with contained thumbnails and keyword pills. Cards use print.webp (blue woodprint); devotional reading + lightbox use raw.jpg (museum photos). Added rawSrc field to ArtworkEntry. Homepage merged hero with prompt pills and featured rail. Series page compact header with 3-view toggle (rails/grid/list) and filtering. Soul Audit option cards: AI primary as large variant, curated prefab as small text-only. Soul Audit matching fix: AI intent parsed before candidate selection with theme scoring weight 4.
- 2026-02-24: Continue Reading rail fix + dark mode image cleanup. Padded Continue Reading section to minimum 3 items using keyword-matched suggested series (prevents single-card full-width stretch). Removed all CSS filter:invert(1) dark mode rules from series thumbnails, devotional artwork, and lightbox images.
- 2026-02-24: Card layout reorder + scripture preview expansion. Card order now Title → Keywords → Image → Scripture → Action. Scripture preview expanded to 2-line clamp (~220 chars) combining framework snippet + series question with ellipsis.
- 2026-02-24: Card image alignment + raw image optimization. Fixed card title (2-line clamp) and keywords (single-line) to consistent heights so thumbnail images align across cards in a rail. Converted 642 raw.jpg → raw.webp (full-size, quality 82) for 28% size reduction (281→202 MB). Updated manifest and generate script to use raw.webp paths. Keywords font reduced to 0.82× base. Scripture line clamp increased to 3 lines.
- 2026-02-24: Devotional image improvements. Switched all preview thumbnails (browse cards, SeriesHero, Soul Audit) from print.webp to raw.webp (full-color). Devotional inline artwork contained to 85% width with 3:2 cinematic crop. Added relevance text to compact attribution (32 SERIES_HERO entries populated). Series detail page now shows hero image in meta sidebar.
- 2026-02-24: Soul Audit persistence + curation fix. All audit state (submit, selection, plan cache, reroll, last input) moved from sessionStorage to localStorage — audits survive refresh. Added LLM provider diagnostics logging. Fallback curation now uses semantic hint expansion for more relevant results when LLM is unavailable.
